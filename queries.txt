//queries

-Alex: query to select all food items currently in the db ordered alphabetically

$query = 'SELECT * FROM food_item
		  ORDER BY item_desc';
$statement = $db->prepare($query);
$statement->execute();
$items = $statement->fetchAll();
$statement->closeCursor();

-Alex: query to select all food items that are close to expiration (maybe like 3 days or something) ordered alphabetically
$query = 'SELECT * FROM food_item
		  ORDER BY item_desc';
		  where expirationdatesetvariable>DATEADD(day,-3, GETDATE())
$statement = $db->prepare($query);
$statement->execute();
$statement->closeCursor();


-Alex: query to select all food items that are new uploads ordered alphabetically
$query = 'SELECT * FROM food_item
		  ORDER BY dateaddedvariable, item_desc';
		  where dateaddedvariable<DATEADD(day,+1, GETDATE())
$statement = $db->prepare($query);
$statement->execute();
$statement->closeCursor();

-Alex: query to select all food items by food category (dairy, bakery items, condiments, etc.) ordered alphabetically, this may need to be an additional field added to the food_item table

-Alex: query to update password for a given user (for the password reset page)

$queryUpdate = 'UPDATE users
				SET u_password = :password
				WHERE u_id = :u_id';
$statement = $db->prepare($queryUpdate);
$statement->bindValue(':u_id', $u_id);
$statement->bindValue(':password', $password);
$statement->execute();
$statement->closeCursor();

-Alex: query(ies) to take the current cart and create a transaction (with transaction lines) for every item in the cart

$query = 'INSERT INTO transactions
			(business_id, trans_total_price, trans_date)
		  VALUES
			(:biz_id, :total_price, :date)';
$statement = $db->prepare($query);
$statement->bindValue(':biz_id', $biz_id);
$statement->bindValue(':total_price', $total_price);
$statement->bindValue(':date', $date);
$statement->execute();
$statement->closeCursor();

$query2 = 'INSERT INTO transaction_line
			(item_id, item_quantity)
		   VALUES
			(:i_id, :item_qty)
			WHERE trans_id = :t_id';
$statement2 = $db->prepare($query);
$statement2->bindValue(':i_id', $i_id);
$statement2->bindValue(':item_qty',$item_qty);
$statement2->bindValue(':t_id', $t_id);
$statement2->execute();
$statement2->closeCursor();

-Alex: query to select all business names and ID's ordered alphabetically

$query = 'SELECT * FROM businesses
		  ORDER BY business_name';
$statement = $db->prepare($query);
$statement->execute();
$businesses = $statement->fetchAll();
$statement->closeCursor();

-Alex: query to pull access logs by business ID (or business name)

$query = 'SELECT * FROM access_log, business, user_to_business WHERE
		  access_log.u_id = user_to_business.u_id
		  AND
		  business.business_id = user_to_business.business_id;';
$statement = $db->prepare($query);
$statement->execute();
$statement->closeCursor();

-Alex: query to update user if they agree to the terms and conditions

$queryUpdate = 'UPDATE users
				SET u_fname = :fname, u_lname = :lname, u_mi = :mi, 
				u_username = :username, u_password = :password, u_phone = :phone,
				u_email = :email, u_photo = :photo, u_is_admin = :admin, u_is_standard = :standard,
				WHERE u_id = :u_id';
$statement = $db ->prepare($queryUpdate);
$statement->bindValue(':fname', $fname);
$statement->bindValue(':lname', $lname);
$statement->bindValue(':mi', $mi);
$statement->bindValue(':username', $username);
$statement->bindValue(':password', $password);
$statement->bindValue(':phone', $phone);
$statement->bindValue(':email', $email);
$statement->bindValue(':photo', $photo);
$statement->bindValue(':admin', $admin);
$statement->bindValue(':standard', $standard);
$statement->execute();
$statement->closeCursor();


//query to display username, photo, name (Adrian)

$query = 'SELECT u_photo, u_username, u_fname, u_lname FROM users
		  WHERE u_id = :u_id';
$statement = $db->prepare($query);
$statement->execute();
$u_info = $statement->fetch();
$statement->closeCursor();

-Adrian: Insert statement for food items to food_items table (database insertion)

$query = 'INSERT INTO food_item 
			(item_desc, business_id, item_qty_avail, item_price, item_perishable, item_expiration)
		  VALUES
			(:desc, :biz_id, :qty_avail, :price, :perish, :expiration)';
$statement = $db->prepare($query);
$statement->bindValue(':desc', $desc);
$statement->bindValue(':biz_id', $biz_id);
$statement->bindValue(':qty_avail', $qty_avail);
$statement->bindValue(':price', $price);
$statement->bindValue(':perish', $perish);
$statement->bindValue(':expiration', $expiration);
$statement->execute();
$statement->closeCursor();

-Adrian: Select statement for users and businesses so I can populate food items on pages

$query = 'SELECT * FROM food_item WHERE
		  :biz_id = business_id';
$statement = $db->prepare($query);
$statement->bindValue(':biz_id', $biz_id);
$statement->execute();
$statement->closeCursor();

-Adrian: Delete statement to delete food_items from the database

$query = 'DELETE FROM food_item
		  WHERE :item_id = item_id';
$statement = $db->prepare($query);
$statement->bindValue(':item_id', $item_id);
$statement->execute();
$statement->closeCursor();

-Adrian: Query to display food by zipcode

$query = 'SELECT * FROM food_item WHERE
		  :biz_id = business_id
		  AND
		  :zip = business.business_zip';
$statement = $db->prepare($query);
$statement->bindValue(':biz_id', $biz_id);
$statement->bindValue(':zip', $zip);
$statement->execute();
$statement->closeCursor();
